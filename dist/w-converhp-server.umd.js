/*!
 * w-converhp-server v1.0.40
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@hapi/hapi"),require("@hapi/inert"),require("events"),require("stream")):"function"==typeof define&&define.amd?define(["@hapi/hapi","@hapi/inert","events","stream"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-converhp-server"]=e(t["@hapi/hapi"],t["@hapi/inert"],t.events,t.stream)}(this,(function(t,e,r,n){"use strict";var o=Array.isArray,i="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,a=i||u||Function("return this")(),c=a.Symbol,f=Object.prototype,s=f.hasOwnProperty,l=f.toString,p=c?c.toStringTag:void 0;var h=Object.prototype.toString;var v="[object Null]",y="[object Undefined]",d=c?c.toStringTag:void 0;function b(t){return null==t?void 0===t?y:v:d&&d in Object(t)?function(t){var e=s.call(t,p),r=t[p];try{t[p]=void 0;var n=!0}catch(t){}var o=l.call(t);return n&&(e?t[p]=r:delete t[p]),o}(t):function(t){return h.call(t)}(t)}function g(t){return null!=t&&"object"==typeof t}var j="[object Symbol]";function _(t){return"symbol"==typeof t||g(t)&&b(t)==j}var w=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/;function A(t,e){if(o(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!_(t))||(m.test(t)||!w.test(t)||null!=e&&t in Object(e))}function O(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var x="[object AsyncFunction]",S="[object Function]",B="[object GeneratorFunction]",U="[object Proxy]";function z(t){if(!O(t))return!1;var e=b(t);return e==S||e==B||e==x||e==U}var M,C=a["__core-js_shared__"],E=(M=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+M:"";var N=Function.prototype.toString;function P(t){if(null!=t){try{return N.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var k=/^\[object .+?Constructor\]$/,I=Function.prototype,T=Object.prototype,L=I.toString,F=T.hasOwnProperty,$=RegExp("^"+L.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function D(t){return!(!O(t)||(e=t,E&&E in e))&&(z(t)?$:k).test(P(t));var e}function R(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return D(r)?r:void 0}var H=R(Object,"create");var q=Object.prototype.hasOwnProperty;var V=Object.prototype.hasOwnProperty;function W(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function J(t,e){return t===e||t!=t&&e!=e}function G(t,e){for(var r=t.length;r--;)if(J(t[r][0],e))return r;return-1}W.prototype.clear=function(){this.__data__=H?H(null):{},this.size=0},W.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},W.prototype.get=function(t){var e=this.__data__;if(H){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return q.call(e,t)?e[t]:void 0},W.prototype.has=function(t){var e=this.__data__;return H?void 0!==e[t]:V.call(e,t)},W.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=H&&void 0===e?"__lodash_hash_undefined__":e,this};var K=Array.prototype.splice;function Q(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Q.prototype.clear=function(){this.__data__=[],this.size=0},Q.prototype.delete=function(t){var e=this.__data__,r=G(e,t);return!(r<0)&&(r==e.length-1?e.pop():K.call(e,r,1),--this.size,!0)},Q.prototype.get=function(t){var e=this.__data__,r=G(e,t);return r<0?void 0:e[r][1]},Q.prototype.has=function(t){return G(this.__data__,t)>-1},Q.prototype.set=function(t,e){var r=this.__data__,n=G(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var X=R(a,"Map");function Y(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Z(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.size=0,this.__data__={hash:new W,map:new(X||Q),string:new W}},Z.prototype.delete=function(t){var e=Y(this,t).delete(t);return this.size-=e?1:0,e},Z.prototype.get=function(t){return Y(this,t).get(t)},Z.prototype.has=function(t){return Y(this,t).has(t)},Z.prototype.set=function(t,e){var r=Y(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var tt="Expected a function";function et(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(tt);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(et.Cache||Z),r}et.Cache=Z;var rt,nt,ot,it=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ut=/\\(\\)?/g,at=(rt=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(it,(function(t,r,n,o){e.push(n?o.replace(ut,"$1"):r||t)})),e},nt=et(rt,(function(t){return 500===ot.size&&ot.clear(),t})),ot=nt.cache,nt),ct=at;function ft(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var st=1/0,lt=c?c.prototype:void 0,pt=lt?lt.toString:void 0;function ht(t){if("string"==typeof t)return t;if(o(t))return ft(t,ht)+"";if(_(t))return pt?pt.call(t):"";var e=t+"";return"0"==e&&1/t==-st?"-0":e}function vt(t){return null==t?"":ht(t)}function yt(t,e){return o(t)?t:A(t,e)?[t]:ct(vt(t))}var dt=1/0;function bt(t){if("string"==typeof t||_(t))return t;var e=t+"";return"0"==e&&1/t==-dt?"-0":e}function gt(t,e){for(var r=0,n=(e=yt(e,t)).length;null!=t&&r<n;)t=t[bt(e[r++])];return r&&r==n?t:void 0}function jt(t,e,r){var n=null==t?void 0:gt(t,e);return void 0===n?r:n}function _t(t){var e=this.__data__=new Q(t);this.size=e.size}_t.prototype.clear=function(){this.__data__=new Q,this.size=0},_t.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},_t.prototype.get=function(t){return this.__data__.get(t)},_t.prototype.has=function(t){return this.__data__.has(t)},_t.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Q){var n=r.__data__;if(!X||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Z(n)}return r.set(t,e),this.size=r.size,this};function wt(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Z;++e<r;)this.add(t[e])}function mt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function At(t,e){return t.has(e)}wt.prototype.add=wt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},wt.prototype.has=function(t){return this.__data__.has(t)};var Ot=1,xt=2;function St(t,e,r,n,o,i){var u=r&Ot,a=t.length,c=e.length;if(a!=c&&!(u&&c>a))return!1;var f=i.get(t),s=i.get(e);if(f&&s)return f==e&&s==t;var l=-1,p=!0,h=r&xt?new wt:void 0;for(i.set(t,e),i.set(e,t);++l<a;){var v=t[l],y=e[l];if(n)var d=u?n(y,v,l,e,t,i):n(v,y,l,t,e,i);if(void 0!==d){if(d)continue;p=!1;break}if(h){if(!mt(e,(function(t,e){if(!At(h,e)&&(v===t||o(v,t,r,n,i)))return h.push(e)}))){p=!1;break}}else if(v!==y&&!o(v,y,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p}var Bt=a.Uint8Array;function Ut(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function zt(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var Mt=1,Ct=2,Et="[object Boolean]",Nt="[object Date]",Pt="[object Error]",kt="[object Map]",It="[object Number]",Tt="[object RegExp]",Lt="[object Set]",Ft="[object String]",$t="[object Symbol]",Dt="[object ArrayBuffer]",Rt="[object DataView]",Ht=c?c.prototype:void 0,qt=Ht?Ht.valueOf:void 0;function Vt(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}function Wt(t,e,r){var n=e(t);return o(t)?n:Vt(n,r(t))}function Jt(){return[]}var Gt=Object.prototype.propertyIsEnumerable,Kt=Object.getOwnPropertySymbols,Qt=Kt?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(Kt(t),(function(e){return Gt.call(t,e)})))}:Jt,Xt=Qt;function Yt(t){return g(t)&&"[object Arguments]"==b(t)}var Zt=Object.prototype,te=Zt.hasOwnProperty,ee=Zt.propertyIsEnumerable,re=Yt(function(){return arguments}())?Yt:function(t){return g(t)&&te.call(t,"callee")&&!ee.call(t,"callee")},ne=re;var oe="object"==typeof exports&&exports&&!exports.nodeType&&exports,ie=oe&&"object"==typeof module&&module&&!module.nodeType&&module,ue=ie&&ie.exports===oe?a.Buffer:void 0,ae=(ue?ue.isBuffer:void 0)||function(){return!1},ce=9007199254740991,fe=/^(?:0|[1-9]\d*)$/;function se(t,e){var r=typeof t;return!!(e=null==e?ce:e)&&("number"==r||"symbol"!=r&&fe.test(t))&&t>-1&&t%1==0&&t<e}var le=9007199254740991;function pe(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=le}var he={};function ve(t){return function(e){return t(e)}}he["[object Float32Array]"]=he["[object Float64Array]"]=he["[object Int8Array]"]=he["[object Int16Array]"]=he["[object Int32Array]"]=he["[object Uint8Array]"]=he["[object Uint8ClampedArray]"]=he["[object Uint16Array]"]=he["[object Uint32Array]"]=!0,he["[object Arguments]"]=he["[object Array]"]=he["[object ArrayBuffer]"]=he["[object Boolean]"]=he["[object DataView]"]=he["[object Date]"]=he["[object Error]"]=he["[object Function]"]=he["[object Map]"]=he["[object Number]"]=he["[object Object]"]=he["[object RegExp]"]=he["[object Set]"]=he["[object String]"]=he["[object WeakMap]"]=!1;var ye="object"==typeof exports&&exports&&!exports.nodeType&&exports,de=ye&&"object"==typeof module&&module&&!module.nodeType&&module,be=de&&de.exports===ye&&i.process,ge=function(){try{var t=de&&de.require&&de.require("util").types;return t||be&&be.binding&&be.binding("util")}catch(t){}}(),je=ge&&ge.isTypedArray,_e=je?ve(je):function(t){return g(t)&&pe(t.length)&&!!he[b(t)]},we=Object.prototype.hasOwnProperty;function me(t,e){var r=o(t),n=!r&&ne(t),i=!r&&!n&&ae(t),u=!r&&!n&&!i&&_e(t),a=r||n||i||u,c=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],f=c.length;for(var s in t)!e&&!we.call(t,s)||a&&("length"==s||i&&("offset"==s||"parent"==s)||u&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||se(s,f))||c.push(s);return c}var Ae=Object.prototype;function Oe(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ae)}function xe(t,e){return function(r){return t(e(r))}}var Se=xe(Object.keys,Object),Be=Object.prototype.hasOwnProperty;function Ue(t){if(!Oe(t))return Se(t);var e=[];for(var r in Object(t))Be.call(t,r)&&"constructor"!=r&&e.push(r);return e}function ze(t){return null!=t&&pe(t.length)&&!z(t)}function Me(t){return ze(t)?me(t):Ue(t)}function Ce(t){return Wt(t,Me,Xt)}var Ee=1,Ne=Object.prototype.hasOwnProperty;var Pe=R(a,"DataView"),ke=R(a,"Promise"),Ie=R(a,"Set"),Te=R(a,"WeakMap"),Le="[object Map]",Fe="[object Promise]",$e="[object Set]",De="[object WeakMap]",Re="[object DataView]",He=P(Pe),qe=P(X),Ve=P(ke),We=P(Ie),Je=P(Te),Ge=b;(Pe&&Ge(new Pe(new ArrayBuffer(1)))!=Re||X&&Ge(new X)!=Le||ke&&Ge(ke.resolve())!=Fe||Ie&&Ge(new Ie)!=$e||Te&&Ge(new Te)!=De)&&(Ge=function(t){var e=b(t),r="[object Object]"==e?t.constructor:void 0,n=r?P(r):"";if(n)switch(n){case He:return Re;case qe:return Le;case Ve:return Fe;case We:return $e;case Je:return De}return e});var Ke=Ge,Qe=1,Xe="[object Arguments]",Ye="[object Array]",Ze="[object Object]",tr=Object.prototype.hasOwnProperty;function er(t,e,r,n,i,u){var a=o(t),c=o(e),f=a?Ye:Ke(t),s=c?Ye:Ke(e),l=(f=f==Xe?Ze:f)==Ze,p=(s=s==Xe?Ze:s)==Ze,h=f==s;if(h&&ae(t)){if(!ae(e))return!1;a=!0,l=!1}if(h&&!l)return u||(u=new _t),a||_e(t)?St(t,e,r,n,i,u):function(t,e,r,n,o,i,u){switch(r){case Rt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Dt:return!(t.byteLength!=e.byteLength||!i(new Bt(t),new Bt(e)));case Et:case Nt:case It:return J(+t,+e);case Pt:return t.name==e.name&&t.message==e.message;case Tt:case Ft:return t==e+"";case kt:var a=Ut;case Lt:var c=n&Mt;if(a||(a=zt),t.size!=e.size&&!c)return!1;var f=u.get(t);if(f)return f==e;n|=Ct,u.set(t,e);var s=St(a(t),a(e),n,o,i,u);return u.delete(t),s;case $t:if(qt)return qt.call(t)==qt.call(e)}return!1}(t,e,f,r,n,i,u);if(!(r&Qe)){var v=l&&tr.call(t,"__wrapped__"),y=p&&tr.call(e,"__wrapped__");if(v||y){var d=v?t.value():t,b=y?e.value():e;return u||(u=new _t),i(d,b,r,n,u)}}return!!h&&(u||(u=new _t),function(t,e,r,n,o,i){var u=r&Ee,a=Ce(t),c=a.length;if(c!=Ce(e).length&&!u)return!1;for(var f=c;f--;){var s=a[f];if(!(u?s in e:Ne.call(e,s)))return!1}var l=i.get(t),p=i.get(e);if(l&&p)return l==e&&p==t;var h=!0;i.set(t,e),i.set(e,t);for(var v=u;++f<c;){var y=t[s=a[f]],d=e[s];if(n)var b=u?n(d,y,s,e,t,i):n(y,d,s,t,e,i);if(!(void 0===b?y===d||o(y,d,r,n,i):b)){h=!1;break}v||(v="constructor"==s)}if(h&&!v){var g=t.constructor,j=e.constructor;g==j||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof j&&j instanceof j||(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,i,u))}function rr(t,e,r,n,o){return t===e||(null==t||null==e||!g(t)&&!g(e)?t!=t&&e!=e:er(t,e,r,n,rr,o))}var nr=1,or=2;function ir(t){return t==t&&!O(t)}function ur(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function ar(t){var e=function(t){for(var e=Me(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,ir(o)]}return e}(t);return 1==e.length&&e[0][2]?ur(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var a=r[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var c=(a=r[o])[0],f=t[c],s=a[1];if(u&&a[2]){if(void 0===f&&!(c in t))return!1}else{var l=new _t;if(n)var p=n(f,s,c,t,e,l);if(!(void 0===p?rr(s,f,nr|or,n,l):p))return!1}}return!0}(r,t,e)}}function cr(t,e){return null!=t&&e in Object(t)}function fr(t,e){return null!=t&&function(t,e,r){for(var n=-1,i=(e=yt(e,t)).length,u=!1;++n<i;){var a=bt(e[n]);if(!(u=null!=t&&r(t,a)))break;t=t[a]}return u||++n!=i?u:!!(i=null==t?0:t.length)&&pe(i)&&se(a,i)&&(o(t)||ne(t))}(t,e,cr)}var sr=1,lr=2;function pr(t){return t}function hr(t){return function(e){return null==e?void 0:e[t]}}function vr(t){return A(t)?hr(bt(t)):function(t){return function(e){return gt(e,t)}}(t)}function yr(t){return"function"==typeof t?t:null==t?pr:"object"==typeof t?o(t)?(e=t[0],r=t[1],A(e)&&ir(r)?ur(bt(e),r):function(t){var n=jt(t,e);return void 0===n&&n===r?fr(t,e):rr(r,n,sr|lr)}):ar(t):vr(t);var e,r}var dr,br=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),u=i.length;u--;){var a=i[dr?u:++n];if(!1===e(o[a],a,o))break}return t};var gr=function(t,e){return function(r,n){if(null==r)return r;if(!ze(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}((function(t,e){return t&&br(t,e,Me)})),jr=gr;function _r(t,e){var r=-1,n=ze(t)?Array(t.length):[];return jr(t,(function(t,o,i){n[++r]=e(t,o,i)})),n}function wr(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}function mr(t,e){var r;return(o(t)?wr:jr)(t,"function"==typeof(r=e)?r:pr)}var Ar=function(){try{var t=R(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Or=Ar;function xr(t,e,r){"__proto__"==e&&Or?Or(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Sr=Object.prototype.hasOwnProperty;function Br(t,e,r){var n=t[e];Sr.call(t,e)&&J(n,r)&&(void 0!==r||e in t)||xr(t,e,r)}function Ur(t,e,r,n){var o=!r;r||(r={});for(var i=-1,u=e.length;++i<u;){var a=e[i],c=n?n(r[a],t[a],a,r,t):void 0;void 0===c&&(c=t[a]),o?xr(r,a,c):Br(r,a,c)}return r}var zr=Object.prototype.hasOwnProperty;function Mr(t){if(!O(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Oe(t),r=[];for(var n in t)("constructor"!=n||!e&&zr.call(t,n))&&r.push(n);return r}function Cr(t){return ze(t)?me(t,!0):Mr(t)}var Er="object"==typeof exports&&exports&&!exports.nodeType&&exports,Nr=Er&&"object"==typeof module&&module&&!module.nodeType&&module,Pr=Nr&&Nr.exports===Er?a.Buffer:void 0,kr=Pr?Pr.allocUnsafe:void 0;var Ir=xe(Object.getPrototypeOf,Object),Tr=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Vt(e,Xt(t)),t=Ir(t);return e}:Jt,Lr=Tr;function Fr(t){return Wt(t,Cr,Lr)}var $r=Object.prototype.hasOwnProperty;function Dr(t){var e=new t.constructor(t.byteLength);return new Bt(e).set(new Bt(t)),e}var Rr=/\w*$/;var Hr=c?c.prototype:void 0,qr=Hr?Hr.valueOf:void 0;var Vr="[object Boolean]",Wr="[object Date]",Jr="[object Map]",Gr="[object Number]",Kr="[object RegExp]",Qr="[object Set]",Xr="[object String]",Yr="[object Symbol]",Zr="[object ArrayBuffer]",tn="[object DataView]",en="[object Float32Array]",rn="[object Float64Array]",nn="[object Int8Array]",on="[object Int16Array]",un="[object Int32Array]",an="[object Uint8Array]",cn="[object Uint8ClampedArray]",fn="[object Uint16Array]",sn="[object Uint32Array]";function ln(t,e,r){var n,o=t.constructor;switch(e){case Zr:return Dr(t);case Vr:case Wr:return new o(+t);case tn:return function(t,e){var r=e?Dr(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case en:case rn:case nn:case on:case un:case an:case cn:case fn:case sn:return function(t,e){var r=e?Dr(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,r);case Jr:return new o;case Gr:case Xr:return new o(t);case Kr:return function(t){var e=new t.constructor(t.source,Rr.exec(t));return e.lastIndex=t.lastIndex,e}(t);case Qr:return new o;case Yr:return n=t,qr?Object(qr.call(n)):{}}}var pn=Object.create,hn=function(){function t(){}return function(e){if(!O(e))return{};if(pn)return pn(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),vn=hn;var yn=ge&&ge.isMap,dn=yn?ve(yn):function(t){return g(t)&&"[object Map]"==Ke(t)};var bn=ge&&ge.isSet,gn=bn?ve(bn):function(t){return g(t)&&"[object Set]"==Ke(t)},jn=1,_n=2,wn=4,mn="[object Arguments]",An="[object Function]",On="[object GeneratorFunction]",xn="[object Object]",Sn={};function Bn(t,e,r,n,i,u){var a,c=e&jn,f=e&_n,s=e&wn;if(r&&(a=i?r(t,n,i,u):r(t)),void 0!==a)return a;if(!O(t))return t;var l=o(t);if(l){if(a=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&$r.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!c)return function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t,a)}else{var p=Ke(t),h=p==An||p==On;if(ae(t))return function(t,e){if(e)return t.slice();var r=t.length,n=kr?kr(r):new t.constructor(r);return t.copy(n),n}(t,c);if(p==xn||p==mn||h&&!i){if(a=f||h?{}:function(t){return"function"!=typeof t.constructor||Oe(t)?{}:vn(Ir(t))}(t),!c)return f?function(t,e){return Ur(t,Lr(t),e)}(t,function(t,e){return t&&Ur(e,Cr(e),t)}(a,t)):function(t,e){return Ur(t,Xt(t),e)}(t,function(t,e){return t&&Ur(e,Me(e),t)}(a,t))}else{if(!Sn[p])return i?t:{};a=ln(t,p,c)}}u||(u=new _t);var v=u.get(t);if(v)return v;u.set(t,a),gn(t)?t.forEach((function(n){a.add(Bn(n,e,r,n,t,u))})):dn(t)&&t.forEach((function(n,o){a.set(o,Bn(n,e,r,o,t,u))}));var y=l?void 0:(s?f?Fr:Ce:f?Cr:Me)(t);return wr(y||t,(function(n,o){y&&(n=t[o=n]),Br(a,o,Bn(n,e,r,o,t,u))})),a}Sn[mn]=Sn["[object Array]"]=Sn["[object ArrayBuffer]"]=Sn["[object DataView]"]=Sn["[object Boolean]"]=Sn["[object Date]"]=Sn["[object Float32Array]"]=Sn["[object Float64Array]"]=Sn["[object Int8Array]"]=Sn["[object Int16Array]"]=Sn["[object Int32Array]"]=Sn["[object Map]"]=Sn["[object Number]"]=Sn[xn]=Sn["[object RegExp]"]=Sn["[object Set]"]=Sn["[object String]"]=Sn["[object Symbol]"]=Sn["[object Uint8Array]"]=Sn["[object Uint8ClampedArray]"]=Sn["[object Uint16Array]"]=Sn["[object Uint32Array]"]=!0,Sn["[object Error]"]=Sn[An]=Sn["[object WeakMap]"]=!1;var Un=1,zn=4;function Mn(t){return Bn(t,Un|zn)}function Cn(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}var En="[object String]";var Nn=hr("length"),Pn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var kn="\\ud800-\\udfff",In="["+kn+"]",Tn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ln="\\ud83c[\\udffb-\\udfff]",Fn="[^"+kn+"]",$n="(?:\\ud83c[\\udde6-\\uddff]){2}",Dn="[\\ud800-\\udbff][\\udc00-\\udfff]",Rn="(?:"+Tn+"|"+Ln+")"+"?",Hn="[\\ufe0e\\ufe0f]?",qn=Hn+Rn+("(?:\\u200d(?:"+[Fn,$n,Dn].join("|")+")"+Hn+Rn+")*"),Vn="(?:"+[Fn+Tn+"?",Tn,$n,Dn,In].join("|")+")",Wn=RegExp(Ln+"(?="+Ln+")|"+Vn+qn,"g");function Jn(t){return function(t){return Pn.test(t)}(t)?function(t){for(var e=Wn.lastIndex=0;Wn.test(t);)++e;return e}(t):Nn(t)}var Gn="[object Map]",Kn="[object Set]";function Qn(t){if(null==t)return 0;if(ze(t))return"string"==typeof(e=t)||!o(e)&&g(e)&&b(e)==En?Jn(t):t.length;var e,r=Ke(t);return r==Gn||r==Kn?t.size:Ue(t).length}var Xn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Yn={};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,u){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new o(n,i||t,u),c=r?r+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,u=new Array(i);o<i;o++)u[o]=n[o].fn;return u},a.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,o,i,u){var a=r?r+t:t;if(!this._events[a])return!1;var c,f,s=this._events[a],l=arguments.length;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),l){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,n),!0;case 4:return s.fn.call(s.context,e,n,o),!0;case 5:return s.fn.call(s.context,e,n,o,i),!0;case 6:return s.fn.call(s.context,e,n,o,i,u),!0}for(f=1,c=new Array(l-1);f<l;f++)c[f-1]=arguments[f];s.fn.apply(s.context,c)}else{var p,h=s.length;for(f=0;f<h;f++)switch(s[f].once&&this.removeListener(t,s[f].fn,void 0,!0),l){case 1:s[f].fn.call(s[f].context);break;case 2:s[f].fn.call(s[f].context,e);break;case 3:s[f].fn.call(s[f].context,e,n);break;case 4:s[f].fn.call(s[f].context,e,n,o);break;default:if(!c)for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];s[f].fn.apply(s[f].context,c)}}return!0},a.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||n&&a.context!==n||u(this,i);else{for(var c=0,f=[],s=a.length;c<s;c++)(a[c].fn!==e||o&&!a[c].once||n&&a[c].context!==n)&&f.push(a[c]);f.length?this._events[i]=1===f.length?f[0]:f:u(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&u(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}({get exports(){return Yn},set exports(t){Yn=t}});var Zn=Yn;var to=/\s/;var eo=/^\s+/;function ro(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&to.test(t.charAt(e)););return e}(t)+1).replace(eo,""):t}var no=NaN,oo=/^[-+]0x[0-9a-f]+$/i,io=/^0b[01]+$/i,uo=/^0o[0-7]+$/i,ao=parseInt;function co(t){if("number"==typeof t)return t;if(_(t))return no;if(O(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=O(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=ro(t);var r=io.test(t);return r||uo.test(t)?ao(t.slice(2),r?2:8):oo.test(t)?no:+t}var fo=1/0,so=17976931348623157e292;function lo(t){return t?(t=co(t))===fo||t===-fo?(t<0?-1:1)*so:t==t?t:0:0===t?t:0}function po(t){var e=lo(t),r=e%1;return e==e?r?e-r:e:0}function ho(t){return"[object String]"===Object.prototype.toString.call(t)}function vo(t){return!(!ho(t)||""===t)}function yo(t){return t!=t}function bo(t){let e=!1;if(vo(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(yo(t))return!1;e=!0}return e}function go(t){if(!bo(t))return 0;return lo(t)}function jo(t){return!!bo(t)&&(t=go(t),"number"==typeof(e=t)&&e==po(e));var e}var _o=a.isFinite,wo=Math.min;var mo=function(t){var e=Math[t];return function(t,r){if(t=co(t),(r=null==r?0:wo(po(r),292))&&_o(t)){var n=(vt(t)+"e").split("e");return+((n=(vt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),Ao=mo;function Oo(t){if(!bo(t))return 0;t=go(t);let e=Ao(t);return"0"===String(e)?0:e}function xo(t){if(!jo(t))return!1;return Oo(t)>0}function So(t){return"[object Object]"===Object.prototype.toString.call(t)}function Bo(t){if(So(t)){for(let e in t)return!0;return!1}return!1}function Uo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Zn,r={},n=null,o=jt(t,"timeAlive");xo(o)||(o=1e4),o=Oo(o);let i=jt(t,"timeDetect");return xo(i)||(i=50),i=Oo(i),e.trigger=function(t,u){vo(t)?(function(t,e){return!!So(t)&&!(!vo(e)&&!bo(e))&&e in t}(r,t)||setTimeout((()=>{e.emit("message",{eventName:"enter",key:t,data:u,now:Qn(r)})}),1),r[t]={data:u,time:Date.now()},null===n&&(n=setInterval((()=>{mr(r,((t,n)=>{if(Date.now()-t.time>o){let t=Mn(r[n]);delete r[n],e.emit("message",{eventName:"leave",key:n,data:t.data,now:Qn(r)})}})),Bo(r)||(clearInterval(n),n=null)}),i))):console.log("trigger need key")},e.get=function(){let t=[];return mr(r,((e,r)=>{t.push({key:r,data:e.data})})),t=Mn(t),t},e}function zo(t){return"[object Array]"===Object.prototype.toString.call(t)}function Mo(t){if(So(t)){for(let e in t)return!1;return!0}return!1}function Co(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!Mo(t)||(!!function(t){return!(!ho(t)||""!==t)}(t)||(!!function(t){return!!zo(t)&&0===t.length}(t)||!!yo(t)))))}function Eo(t){return"[object ArrayBuffer]"===Object.prototype.toString.call(t)}function No(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function Po(t){return"[object Uint16Array]"===Object.prototype.toString.call(t)}function ko(t){if(!(Eo(t)||(e=t,"[object Blob]"===Object.prototype.toString.call(e))||No(t)||Po(t)))return null;var e;try{if(t.byteLength)return t.byteLength}catch(t){}try{if(t.length)return t.length}catch(t){}try{if(t.size)return t.size}catch(t){}return null}var Io="[object Object]",To=Function.prototype,Lo=Object.prototype,Fo=To.toString,$o=Lo.hasOwnProperty,Do=Fo.call(Object);var Ro="[object DOMException]",Ho="[object Error]";function qo(t){if(!g(t))return!1;var e=b(t);return e==Ho||e==Ro||"string"==typeof t.message&&"string"==typeof t.name&&!function(t){if(!g(t)||b(t)!=Io)return!1;var e=Ir(t);if(null===e)return!0;var r=$o.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Fo.call(r)==Do}(t)}var Vo={};var Wo,Jo={},Go={get exports(){return Jo},set exports(t){Jo=t}};function Ko(){return Wo||(Wo=1,function(t,e){var r;t.exports=(r=r||function(t,e){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==Xn&&Xn.crypto&&(r=Xn.crypto),!r)try{r=require("crypto")}catch(t){}var n=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(e){var r;return t.prototype=e,r=new t,t.prototype=null,r}}(),i={},u=i.lib={},a=u.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},c=u.WordArray=a.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=r!=e?r:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,r=t.words,n=this.sigBytes,o=t.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var u=r[i>>>2]>>>24-i%4*8&255;e[n+i>>>2]|=u<<24-(n+i)%4*8}else for(var a=0;a<o;a+=4)e[n+a>>>2]=r[a>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],r=0;r<t;r+=4)e.push(n());return new c.init(e,t)}}),f=i.enc={},s=f.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],o=0;o<r;o++){var i=e[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new c.init(r,e/2)}},l=f.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],o=0;o<r;o++){var i=e[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new c.init(r,e)}},p=f.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},h=u.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r,n=this._data,o=n.words,i=n.sigBytes,u=this.blockSize,a=i/(4*u),f=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*u,s=t.min(4*f,i);if(f){for(var l=0;l<f;l+=u)this._doProcessBlock(o,l);r=o.splice(0,f),n.sigBytes-=s}return new c.init(r,s)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});u.Hasher=h.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new v.HMAC.init(t,r).finalize(e)}}});var v=i.algo={};return i}(Math),r)}(Go)),Jo}!function(t,e){t.exports=Ko().enc.Utf8}({get exports(){return Vo},set exports(t){Vo=t}});var Qo=Vo,Xo={};!function(t,e){var r;t.exports=(r=Ko(),function(){var t=r,e=t.lib.WordArray;function n(t,r,n){for(var o=[],i=0,u=0;u<r;u++)if(u%4){var a=n[t.charCodeAt(u-1)]<<u%4*2|n[t.charCodeAt(u)]>>>6-u%4*2;o[i>>>2]|=a<<24-i%4*8,i++}return e.create(o,i)}t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,n=this._map;t.clamp();for(var o=[],i=0;i<r;i+=3)for(var u=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<r;a++)o.push(n.charAt(u>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(t){var e=t.length,r=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<r.length;i++)o[r.charCodeAt(i)]=i}var u=r.charAt(64);if(u){var a=t.indexOf(u);-1!==a&&(e=a)}return n(t,e,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),r.enc.Base64)}({get exports(){return Xo},set exports(t){Xo=t}});var Yo=Xo;function Zo(t){if(!vo(t))return new Uint8Array;let e;try{e=function(t){if(!ho(t))return new Uint8Array;let e=Yo.parse(t),r=e.words,n=e.sigBytes,o=new Uint8Array(n);for(let t=0;t<n;t++){let e=r[t>>>2]>>>24-t%4*8&255;o[t]=e}return o}(function(t){if(!vo(t))return"";let e=Qo.parse(t);return Yo.stringify(e)}(t))}catch(t){return new Uint8Array}return e}var ti="[object Boolean]";function ei(t){return!0===(e=t)||!1===e||g(e)&&b(e)==ti;var e}function ri(t,e){return function(t,e,r,n,o,i){if(!bo(t))return null;if(!No(e))return null;if(!jo(r))return null;if(!ei(n))return null;if(!jo(o))return null;if(!jo(i))return null;let u,a,c;t=go(t);let f=8*i-o-1,s=(1<<f)-1,l=s>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?i-1:0,v=n?-1:1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,u=s):(u=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-u))<1&&(u--,c*=2),(t+=u+l>=1?p/c:p*Math.pow(2,1-l))*c>=2&&(u++,c/=2),u+l>=s?(a=0,u=s):u+l>=1?(a=(t*c-1)*Math.pow(2,o),u+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),u=0));o>=8;e[r+h]=255&a,h+=v,a/=256,o-=8);for(u=u<<o|a,f+=o;f>0;e[r+h]=255&u,h+=v,u/=256,f-=8);return e[r+h-v]|=128*y,null}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,!(arguments.length>3&&void 0!==arguments[3])||arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:52,arguments.length>5&&void 0!==arguments[5]?arguments[5]:8)}function ni(t){let e=[],r=[];if((!zo(n=t)||0===n.length||1===n.length&&Co(n[0]))&&!Bo(t))return null;var n;let o=[],i=[];function u(t){o.push(ko(t)),i.push(t)}try{let n=function(t){if(!So(t))return{results:"",binarys:[]};if(Mo(t))return{results:"",binarys:[]};let e="",r=[];try{let n=-1;e=JSON.stringify(t,(function(t,e){if(No(e)){n+=1;let t=`[Uint8Array]::${n}`;return r.push(e),t}if(Po(e)){n+=1;let t=`[Uint16Array]::${n}`;return r.push(e),t}if(Eo(e)){n+=1;let t=`[ArrayBuffer]::${n}`;return r.push(e),t}return qo(e)&&(e=e.toString()),e}))}catch(t){}return{results:e,binarys:r}}(t);u(Zo(n.results)),mr(n.binarys,(t=>{u(t)}));let a=o,c=Zo(JSON.stringify(a)),f=new Uint8Array(8);ri(ko(c),f),e.push(f),e.push(c),mr(i,(t=>{e.push(t)})),mr(e,(t=>{r=function(t,e){let r=ko(t),n=ko(e),o=new Uint8Array(r+n);return o.set(new Uint8Array(t),0),o.set(new Uint8Array(e),r),o}(r,t)}))}catch(t){return null}return r}function oi(t){return function(t,e,r,n,o){if(!No(t))return null;if(!jo(e))return null;if(!ei(r))return null;if(!jo(n))return null;if(!jo(o))return null;let i,u,a=8*o-n-1,c=(1<<a)-1,f=c>>1,s=-7,l=r?0:o-1,p=r?1:-1,h=t[e+l];for(l+=p,i=h&(1<<-s)-1,h>>=-s,s+=a;s>0;i=256*i+t[e+l],l+=p,s-=8);for(u=i&(1<<-s)-1,i>>=-s,s+=n;s>0;u=256*u+t[e+l],l+=p,s-=8);if(0===i)i=1-f;else{if(i===c)return u?NaN:1/0*(h?-1:1);u+=Math.pow(2,n),i-=f}return(h?-1:1)*u*Math.pow(2,i-n)}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!(arguments.length>2&&void 0!==arguments[2])||arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:52,arguments.length>4&&void 0!==arguments[4]?arguments[4]:8)}var ii={};!function(t,e){var r;t.exports=(r=Ko(),function(){if("function"==typeof ArrayBuffer){var t=r.lib.WordArray,e=t.init,n=t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var r=t.byteLength,n=[],o=0;o<r;o++)n[o>>>2]|=t[o]<<24-o%4*8;e.call(this,n,r)}else e.apply(this,arguments)};n.prototype=t}}(),r.lib.WordArray)}({get exports(){return ii},set exports(t){ii=t}});var ui=ii;function ai(t){if(!No(t))return"";let e;try{r=function(t){return No(t)?ui.create(t).toString(Yo):""}(t),e=vo(r)?Yo.parse(r).toString(Qo):""}catch(t){return""}var r;return e}function ci(t){let e=null;if(!No(t))return null;try{let r=8,n=t.slice(0,r),o=t.slice(r,ko(t)),i=oi(n),u=o.slice(0,i),a=o.slice(i,ko(o)),c=ai(u),f=function(t,e){let r=0,n=0,o=[];return mr(e,(e=>{n=r+e;let i=t.slice(r,n);r=n,o.push(i)})),o}(a,JSON.parse(c));e=function(t){if(!Bo(t))return{};let{results:e,binarys:r}=t;if(!vo(e))return{};if(!zo(r))return{};let n={};try{n=JSON.parse(e,(function(t,e){if(vo(e)){if(e.indexOf("[Uint8Array]::")>=0){let t=Oo(e.replace("[Uint8Array]::",""));return r[t]}if(e.indexOf("[Uint16Array]::")>=0){let t=Oo(e.replace("[Uint16Array]::",""));return r[t]}if(e.indexOf("[ArrayBuffer]::")>=0){let t=Oo(e.replace("[ArrayBuffer]::",""));return r[t]}}return e}))}catch(t){}return n}({results:ai(f.shift()),binarys:f})}catch(t){}return e}return function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u={};i.port||(i.port=8080),i.apiName||(i.apiName="api");let a,c=new r.EventEmitter,f=Uo();function s(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];setTimeout((()=>{c.emit(t,...r)}),1)}async function l(t){let e=Cn(),r=Cn(),n=jt(t,"_mode","");if(r.then((r=>{t.output=r,delete t.input,e.resolve(t)})).catch((t=>{e.reject(t)})),"execute"===n){s("execute",jt(t,"func",""),jt(t,"input",null),r)}else if("broadcast"===n){s("broadcast",jt(t,"input",null)),r.resolve("ok")}else if("deliver"===n){s("deliver",jt(t,"input",null)),r.resolve("ok")}else if("polling"===n){let e=jt(t,"clientId",""),n=jt(u,e,[]);n=Mn(n),u[e]=[],r.resolve(n)}else{let n="can not find _mode in data";!function(t,e){s("error",{msg:t,err:e})}(n,t),e.reject(n),r.reject()}return e}setInterval((()=>{let t=f.get(),e=(n="key",(o(r=t)?ft:_r)(r,yr(n)));var r,n;let i={};mr(e,(t=>{i[t]=jt(u,t,[])})),u=i}),1e3),a=i.serverHapi?i.serverHapi:t.server({port:i.port,routes:{cors:{origin:["*"]}}}),s("open"),f.on("message",(function(t){let{eventName:e,key:r,data:n,now:o}=t;"enter"===e?s("clientEnter",r,n):"leave"===e&&s("clientLeave",r,n),s("clientChange",o)}));let p={path:"/"+i.apiName,method:"POST",options:{payload:{maxBytes:1073741824,timeout:18e4,multipart:!0},timeout:{socket:3e5}},handler:async function(t,e){let r=jt(t,"headers");r=Bo(r)?r:"";let o=jt(t,"query");o=Bo(o)?o:"",s("handler",{headers:r,query:o});let i=jt(t,"payload.bb",null);ho(i)&&(i=Buffer.from(i,"utf8"));let u=ci(new Uint8Array(i)),a=jt(u,"clientId"),c={headers:t.headers,info:t.info};f.trigger(a,c);let p={};await l(u).then((function(t){p.success=t})).catch((function(t){p.error=t}));let h=ni(p),v=new n.Readable;return v._read=()=>{},v.push(h),v.push(null),e.response(v).header("Cache-Control","no-cache, no-store, must-revalidate").header("Content-Type","application/octet-stream").header("Content-Length",v.readableLength)}};return c.broadcast=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(Co(u))return;let r={};mr(u,((e,n)=>{e.push({mode:"broadcast",data:t}),r[n]=e})),u=r,e(100)},c.deliver=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=jt(u,t,[]);n.push({mode:"deliver",data:e}),u[t]=n,r(100)},i.serverHapi?i.serverHapi.route(p):async function(){await a.register(e),a.route([{method:"GET",path:"/{file*}",handler:{directory:{path:"./"}}},p]),await a.start(),console.log(`Server running at: ${a.info.uri}`)}(),c}}));
//# sourceMappingURL=w-converhp-server.umd.js.map
